---
import Layout from "../../../layouts/Layout.astro";
import { getCollection } from "astro:content";
import ArticleCard from "../../../components/articles/ArticleCard.astro";

export async function getStaticPaths() {
    const categories = await getCollection("categories");

    return categories.map((category) => ({
        params: { category: category.slug },
        props: { category }
    }));
};

const { category } = Astro.props;
const { data, slug } = category;
const { title } = data;

const articles = await getCollection("articles", ({data}) => { return data.category.id === slug });
---

<Layout title={title}>
    <main class="flex flex-col items-center gap-8 mt-4 px-8">
        <h1 class="text-3xl font-bold">{title}</h1>
        <section class="w-full grid grid-cols-1 md:grid-cols-2 gap-8">
            {
                articles.map((article) => {
                    return (
                        <ArticleCard article={article}/>
                    )
                })
            }
        </section>
    </main>
</Layout>